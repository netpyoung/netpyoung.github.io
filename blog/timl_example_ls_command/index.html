<!DOCTYPE html>

<!-- ref: https://bulma.io/ -->
<!-- ref: https://fontawesome.com/icons -->
<!-- ref: https://flagicons.lipis.dev/ -->
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>넷평 남짓한 공간</title>

		<link rel="icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" href="/favicon.ico" type="image/x-icon">
		<link rel="alternate" type="application/atom+xml" title="Atom" href="&#x2F;feed">
		<link rel="stylesheet" href="/main.css">

		<!-- #region: Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-855BJNV9VD"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			
			gtag('config', 'G-855BJNV9VD');
		</script>
		<!-- #endregion: Google tag (gtag.js) -->

		<script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
		<script>mermaid.initialize({ startOnLoad: true });</script>
		<script src="https://cdn.jsdelivr.net/npm/fuse.js@7.1.0"></script>
		<script defer src="/search_index.ko.js"></script>
		<script defer src="/main.js"></script>
		<script defer src="/search.js"></script>
	</head>

	<body class="layout-documentation page-layout">
		<div class="container">
			<nav class="navbar is-transparent is-centered has-shadow is-spaced">
				<!-- <div class="container"> -->
				<div class="navbar-brand">
					<a class="navbar-item" href="&#x2F;">
						<i class="fa-solid fa-home"></i>
						<b>넷평 남짓한 공간</b>
					</a>

					<div class="navbar-burger burger" data-target="navbarExampleTransparentExample">
						<span></span>
						<span></span>
						<span></span>
					</div>
				</div><!-- navbar-brand -->
				<!-- </div> -->

				<div id="navbarExampleTransparentExample" class="navbar-menu">
					<div class="navbar-start">
						<a class="navbar-item " href="&#x2F;overview">
							<i class="fa-solid fa fa-street-view"></i>
						</a>
						<a class="navbar-item " href="&#x2F;company_project">
							<i class="fa-solid fa fa-building"></i>
						</a>
						<a class="navbar-item has-background-grey-lighter" href="&#x2F;blog">
							<i class="fa-solid fa-mug-saucer"></i>
						</a>
						<!-- <a class="navbar-item "
            href="&#x2F;study">
            <i class="fa-solid fa-pen-to-square"></i>
          </a> -->
						<a class="navbar-item " href="&#x2F;external">
							<i class="fa-solid fa-external-link-alt"></i>
						</a>
						<a class="navbar-item " href="&#x2F;diary">
							<i class="fa-solid fa-book"></i>
						</a>
						<a class="navbar-item" href="https:&#x2F;&#x2F;github.com&#x2F;netpyoung">
							<i class="fa-brands fa-github"></i>
						</a>
						<a class="navbar-item" href="/feed.xml">
							<i class="fa-solid fa-rss-square"></i>
						</a>
					</div>
					<!-- navbar-start -->

					<div class="navbar-end">
						<button id="search-button" class="button is-light">
							<span class="icon"><i class="fas fa-search"></i></span>
						</button>

						<div id="search-modal" class="modal">
							<div class="modal-background"></div>
							<div class="modal-content" style="min-height: 70%; max-height: 70%; ">
								<div class="box">
									<div class="field">
										<p class="control has-icons-left">
											<input id="search-input" class="input is-medium" type="text" placeholder="Search...">
											<span class="icon is-small is-left">
												<i class="fas fa-search"></i>
											</span>
										</p>
									</div>
									<div id="search-results" style="overflow-y: auto;"></div>
								</div>
							</div>
							<button id="close-modal" class="modal-close is-large" aria-label="close"></button>
						</div>

						<!--  <div class="dropdown ">
							<div class="dropdown-trigger">
								<button class="button" aria-haspopup="true" aria-controls="dropdown-menu">
									<span>connect</span>
									<span class="icon is-small">
										<i class="fa-solid fa-angle-down" aria-hidden="true"></i>
									</span>
								</button>
							</div>
							<div class="dropdown-menu" id="dropdown-menu" role="menu">
								<div class="dropdown-content">
									<a class="dropdown-item" href="https:&#x2F;&#x2F;facebook.com&#x2F;netpyoung">
										<span class="icon">
											<i class="fa-brands fa-facebook"></i>
										</span>
										facebook
									</a>
								</div>
							</div>
						</div> dropdown-->
					</div>
					<!-- navbar-end -->
				</div>
				<!-- navbar-menu -->
			</nav>

			<div class="content container is-fluid">
				
<h1 class="title">
  Timl example (:Ls Command)
</h1>


  <p class="subtitle"><strong>2014.04.07</strong></p>


<div class="post">
  <h2 id="timliran">Timl이란?</h2>
<ul>
<li><a href="https://github.com/tpope/timl">https://github.com/tpope/timl</a></li>
<li>lisp 방언(dialect)중 하나로, VimL로 컴파일된다. (Clojure가 VimL을 만났다고 생각하면 된다.)</li>
<li>4월 1일날 공개해서, 만우절 낚시인줄 알았는데 잘돌아간다..</li>
<li><a href="http://www.reddit.com/r/Clojure/comments/21x6hr/sbcl_with_support_for_clojure_xpost_from_rlisp/">2014.04.01 sbcl 클로져 지원 낚시</a></li>
</ul>
<h2 id="feature">Feature.</h2>
<ul>
<li>매크로지원:<code>syntax quoting</code>, <code>&amp;form</code>, <code>&amp;env</code>.</li>
<li>레퍼런스타입 지원: vars, atoms, futures.</li>
<li>내장 함수 사용: <code>(#*toupper "TimL is pretty neat")</code></li>
<li>Vim command 호출: <code>(execute "wq")</code></li>
<li>기타 등등.. (공식페이지 참조.)</li>
</ul>
<h2 id="example">Example.</h2>
<ul>
<li><code>:!ls</code>로 Vim <code>밖</code>에서 파일목록을 볼 수 있지만, Vim 버퍼 <code>안</code>에서 ls 명령결과를 확인할 수 있는 플러그 인을 작성해보자.</li>
</ul>
<p>플러그인 구조.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>    [~/.vim]$ tree xxx
</span><span>    xxx
</span><span>    ├── autoload
</span><span>    │   └── xxx
</span><span>    │       └── core.tim
</span><span>    └── plugin
</span><span>        └── xxx.vim
</span></code></pre>
<p>vimrc</p>
<pre data-lang="vim" style="background-color:#2b303b;color:#c0c5ce;" class="language-vim "><code class="language-vim" data-lang="vim"><span style="color:#b48ead;">if </span><span style="color:#8fa1b3;">has</span><span>(</span><span style="color:#a3be8c;">&#39;vim_starting&#39;</span><span>)
</span><span>  </span><span style="color:#96b5b4;">set</span><span> runtimepath+</span><span style="color:#b48ead;">=~</span><span style="color:#96b5b4;">/.vim/</span><span>xxx/
</span><span style="color:#b48ead;">endif
</span></code></pre>
<p>xxx/autoload/xxx/core.tim</p>
<pre data-lang="clojure" style="background-color:#2b303b;color:#c0c5ce;" class="language-clojure "><code class="language-clojure" data-lang="clojure"><span>(</span><span style="color:#bf616a;">ns</span><span> xxx.core)
</span><span>
</span><span>
</span><span style="color:#65737e;">;; ref: http://clojuredocs.org/clojure_core/clojure.core/-&gt;&gt;
</span><span style="color:#65737e;">;; timl에는 `-&gt;`만 들어가 있고, 아직 `-&gt;&gt;`는 들어가 있지 않다.
</span><span style="color:#65737e;">;; 기존 clojure 소스카피
</span><span>
</span><span>
</span><span>(</span><span style="color:#b48ead;">defmacro </span><span style="color:#8fa1b3;">-&gt;&gt;
</span><span>  ([x form] (</span><span style="color:#bf616a;">if </span><span>(</span><span style="color:#bf616a;">seq?</span><span> form)
</span><span>    (</span><span style="color:#bf616a;">with-meta </span><span>`(~(</span><span style="color:#bf616a;">first</span><span> form) ~@(</span><span style="color:#bf616a;">next</span><span> form)  ~x) (</span><span style="color:#bf616a;">meta</span><span> form))
</span><span>    (</span><span style="color:#bf616a;">list</span><span> form x)))
</span><span>  ([x form &amp; more]
</span><span>   `(</span><span style="color:#bf616a;">-&gt;&gt; </span><span>(</span><span style="color:#bf616a;">-&gt;&gt; </span><span>~x ~form) ~@more)))
</span><span>
</span><span>
</span><span>(</span><span style="color:#b48ead;">defn </span><span style="color:#8fa1b3;">ls </span><span>[&amp; args]
</span><span>  (</span><span style="color:#bf616a;">-&gt;&gt;</span><span> args
</span><span>       (</span><span style="color:#bf616a;">concat </span><span>[&quot;</span><span style="color:#a3be8c;">ls</span><span>&quot; &quot;</span><span style="color:#a3be8c;">-al</span><span>&quot;])
</span><span>       (</span><span style="color:#bf616a;">join </span><span>&quot; &quot;)
</span><span>       (#*system)
</span><span>       (</span><span style="color:#bf616a;">println</span><span>)))
</span></code></pre>
<p>xxx/plugin/xxx.vim</p>
<pre data-lang="vim" style="background-color:#2b303b;color:#c0c5ce;" class="language-vim "><code class="language-vim" data-lang="vim"><span style="color:#b48ead;">if </span><span style="color:#8fa1b3;">exists</span><span>(</span><span style="color:#a3be8c;">&quot;g:loaded_xxx&quot;</span><span>) </span><span style="color:#b48ead;">|| </span><span style="color:#bf616a;">v:version</span><span> &lt; </span><span style="color:#d08770;">700 </span><span style="color:#b48ead;">|| </span><span style="color:#bf616a;">&amp;cp
</span><span>    finish
</span><span style="color:#b48ead;">endif
</span><span>
</span><span style="color:#96b5b4;">let </span><span style="color:#bf616a;">g:loaded_xxx</span><span> = </span><span style="color:#d08770;">1
</span><span>
</span><span style="color:#96b5b4;">command</span><span>! -bang -complete=file -nargs=</span><span style="color:#b48ead;">*</span><span> Ls call </span><span style="color:#8fa1b3;">xxx#core#ls</span><span>(&lt;f-args&gt;)
</span></code></pre>
<h2 id="testing">Testing.</h2>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Command. (in Vim)
</span><span>
</span><span>    :Ls ~/.vim/conf.d/ ~/.vim/xxx/
</span><span>
</span><span>Result.
</span><span>
</span><span>    /home/pyoung/.vim/conf.d/:
</span><span>    total 20
</span><span>    drwxrwxr-x 2 pyoung pyoung 4096  4월  7 00:54 .
</span><span>    drwxr-xr-x 7 pyoung pyoung 4096  4월  7 03:59 ..
</span><span>    -rw-rw-r-- 1 pyoung pyoung 2092  4월  7 00:27 00_neobundle.vim
</span><span>    -rw-rw-r-- 1 pyoung pyoung 3518 11월 16 05:46 01_init.vim
</span><span>    -rw-rw-r-- 1 pyoung pyoung   60  4월  7 00:54 02_tim.vim
</span><span>
</span><span>    /home/pyoung/.vim/xxx/:
</span><span>    total 16
</span><span>    drwxrwxr-x 4 pyoung pyoung 4096  4월  7 03:19 .
</span><span>    drwxr-xr-x 7 pyoung pyoung 4096  4월  7 03:59 ..
</span><span>    drwxrwxr-x 3 pyoung pyoung 4096  4월  7 00:54 autoload
</span><span>    drwxrwxr-x 2 pyoung pyoung 4096  4월  7 03:28 plugin
</span><span>
</span><span>
</span><span>    Press ENTER or type command to continue
</span></code></pre>
<h2 id="problem">Problem.</h2>
<ul>
<li>캐쉬 문제.
<ul>
<li>2014.04.07 현재 캐쉬문제가 있다. 한번 컴파일이되면, 다음 변경시 재 컴파일이 안 된채로 에러를 뱉는 문제가 있다.</li>
<li><a href="https://github.com/tpope/timl/issues/12">https://github.com/tpope/timl/issues/12</a></li>
</ul>
</li>
<li>캐쉬 문제 해결.</li>
<li><code>rm -rf ~/.cache/vim/timl/</code>로 캐쉬를 날려주자.</li>
</ul>
<h2 id="tip">Tip.</h2>
<ul>
<li><code>:Wepl</code>: 현재 파일을 로드하면서, repl을 띄움.</li>
<li><code>:TLsource %</code>: 현재 파일을 다시 읽음.(이 역시 캐쉬문제가 발생하면 캐쉬파일 지워주는 수밖에..)</li>
</ul>
<h1 id="reference">Reference.</h1>
<ul>
<li>공식사이트:
<ul>
<li><a href="https://github.com/tpope/timl">https://github.com/tpope/timl</a></li>
</ul>
</li>
<li>tslime2.vim:
<ul>
<li>vim에서 tmux에게 명령어를 보내주는 플러그인.</li>
<li><a href="https://github.com/sjl/tslime2.vim">https://github.com/sjl/tslime2.vim</a></li>
</ul>
</li>
</ul>

</div><!-- post -->

<hr />
<script src="https://utteranc.es/client.js" repo="netpyoung/netpyoung.blog.comment" issue-term="url"
  theme="github-light" crossorigin="anonymous" async></script>
<hr />

			</div><!-- /.content -->

			<!-- <div class="footer">
                 </div> .footer  -->
		</div><!-- /.container -->
	</body>
</html>
